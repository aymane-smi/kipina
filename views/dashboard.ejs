<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
     <link href='../styles/nav.css' rel='stylesheet'>
     <link rel="stylesheet" href="https://cdn.rawgit.com/mfd/09b70eb47474836f25a21660282ce0fd/raw/e06a670afcb2b861ed2ac4a1ef752d062ef6b46b/Gilroy.css">
     <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
   </head>
<body>
  <div class="logo-details">
    <img src="/img/Logo.png">
  </div>
  <div class="sidebar close">
    <ul class="nav-links">
      <li class="li-h" title="accueil">
        <a href="/dashboard" style="margin-left: 20px;" title="accueil">
          <img src="/img/icons/acceuil.png" alt="acceuil">
        </a>
        <p class="title">Accueil</p>
      </li>
      <%if(user.role == 'administrateur' || user.role == 'directrice'){%>
      <li class="li-h" title="modification">
        <a href="/dashboard/modification" style="margin-left: 20px; margin-top:50px;" >
          <img src="/img/icons/etudiant.png">
        </a>
        <p class="title" style="margin-left: 7px;">Modification</p>
      </li>
      <%}%>
      <%if(user.role == 'administrateur' || user.role == 'directrice'){%>
      <li class="li-h" title="rapport">
        <a href="/dashboard/rapport" style="margin-left: 20px; margin-top:50px;" title="rapport">
          <img src="/img/icons/rapport.png">
        </a>
        <p class="title">Rapport</p>
      </li>
      <%}%>
      <%if(user.role == 'administrateur' || user.role == 'directrice'){%>
      <li class="li-h" title="finance">
        <a href="/dashboard/finance" style="margin-left: 20px; margin-top:50px;" title="finance">
          <img src="/img/icons/finance.png">
        </a>
        <p class="title">Finance</p>
      </li>
      <%}%>
      <%if(user.role == 'administrateur' || user.role == 'directrice'){%>
      <li class="li-h" title="english after school">
        <a href="/dashboard/english-after-school" style="margin-left: 25px; margin-top:50px;" title="english after school">
          <img src="/img/icons/english-after-school.png">
        </a>
        <p class="title" style="margin-left:24px;">E.A.S</p>
        <!-- style="margin-left: 22px;">English <span style="margin-left: 5px;">after</span><br>school -->
      </li>
      <%}%>
      <%if(user.role == 'administrateur' || user.role == 'directrice'){%>
      <li class="li-h" title="camps">
        <a href="/dashboard/camps" style="margin-left: 25px; margin-top:50px;" title="camps">
          <img src="/img/icons/camp.png">
        </a>
        <p class="title" style="margin-left: 20px;">Camps</p>
      </li>
      <%}%>
      <%if(user.role == 'educatrice'){%>
      <li class="li-h"  title="ajouter compétence">
        <a href="/dashboard/competence" style="margin-left: 25px; margin-top:50px;" title="ajouter compétence">
          <img src="/img/icons/competence.png">
        </a>
        <p class="title"><span style="margin-left: 5px;">Ajouter</span><br><span style="margin-left: -8px;">compétence</span></p>
      </li>
      <%}%>
      <%if(user.role == 'educatrice'){%>
      <li class="li-h" title="ajouter routine">
        <a href="/dashboard/routine" style="margin-left: 25px; margin-top:50px;" title="ajouter routine">
          <img src="/img/icons/routine.png">
        </a>
        <p class="title"><span style="margin-left: 2px;">Ajouter</span><br><span style="margin-left: 2px;">routine</span></p>
      </li>
      <%}%>
      <%if(user.role == 'directrice'){%>
      <li class="li-h" title="liste des utilisateurs">
        <a href="/dashboard/users" style="margin-left: 20px; margin-top:50px;" title="liste des utilisateurs">
          <img src="/img/icons/gestion-users.png" style="width: 35px; margin-left: 5px;">
        </a>
        <p class="title"><span style="margin-left: 11px;">Liste</span><br><span style="margin-left: 13px;">des<br></span><span>utilisateur</span></p>
      </li>
      <%}%>
      <%if(user.role == 'directrice'){%>
      <li class="li-h" title="Kipinas">
        <a href="/dashboard/kipinas" style="margin-left: 20px; margin-top:50px;" title="Kipinas">
          <img src="/img/icons/kipinas.png" style="margin-left: 4px; width: 40px;">
        </a>
        <p class="title"><span style="margin-left: 5px;">kipinas</p>
      </li>
      <%}%>
      <%if(user.role == 'educatrice'){%>
      <li class="li-h" title="ajouter un plan">
        <a href="/dashboard/plan" style="margin-left: 25px; margin-top:50px;" title="ajouter un plan">
          <img src="/img/icons/plan.png" style="margin-left: -4px;">
        </a>
        <p class="title"><span style="margin-left: 2px;">Ajouter</span><br><span style="margin-left: 8px;">plan</span></p>
      </li>
      <%}%>
      <%if(user.role == 'administrateur' || user.role == 'directrice'){%>
      <li class="li-h" title="liste des plans">
        <a href="/dashboard/list-plan" style="margin-left: 25px; margin-top:50px;" title="liste des plans">
          <img src="/img/icons/liste-plans.png" style="width: 40px; margin-left:-3px;">
        </a>
        <p class="title" style="margin-left:24px;"><span style="margin-left: 2px;">Liste</span><br><span style="margin-left:4px;">des</span><br><span style="margin-left: 2px;">plans</span></p>
      </li>
      <%}%>
      <li class="li-h" title="liste des compétences">
        <%if(user.role == 'administrateur' || user.role == 'directrice'){%>
        <a href="/dashboard/list-competence" style="margin-left: 25px; margin-top:50px;" title="liste des compétences">
          <img src="/img/icons/liste-competences.png" style="width: 40px; margin-left:-3px;">
        </a>
        <p class="title" style="margin-left:24px;"><span style="margin-left: 2px;">Liste</span><br><span style="margin-left:4px;">des</span><br><span style="margin-left: -15px;">compétences</span></p>
      </li>
      <%}%>
    </ul>
  </div>

<!--
container content
-->
  <section class="home-content" >
    <div style="margin-top: 30px; margin-left: 20px;">
      <div class="row">
        <div class="col-lg-7 col-sm-12 text-nowarp flex-nowrap" style="display: flex; align-items: center;">
          <div style="flex-shrink:0;display:inline-block; width: 70px; height: 70px; border-radius: 50%;position: relative;background: linear-gradient(-30deg, #839000, #BCCF00);">
            <img class="rounded-circle" src="../img/avatar.png" style="width: 66px;height: 66px; position: absolute; top: -10px; left: 2px;">
          </div>
          <div style="margin-left: 30px;flex-shrink:0">
              <span class="bjr1-span ">Bonjour</span>
              <span class="bjr2-span">, <%=user.nom%></span>
          </div>
        </div>
        <div class="col-lg col-sm-12">
          <div class="row">
            <div class="col-sm-12 col-lg-6" style="margin-top: 10px;">
              <div class="input-group rounded-pill search shadow" style="background: white; overflow: hidden; border: 0 none; width: 300px; display: inline-block; height: 50px;flex-shrink:0" >
                <div class="input-group-prepend border-0">
                  <button  type="button" id="search-button" style="margin-left: 10px; margin-top: 18px;background: url(../img/icons/search-icon.png) no-repeat center/70%;"class="btn search-enfant"></button>
                  <input type="search" placeholder="search" id="search-input" style="margin-left: 10px; margin-top: 10px;" class="border-0">
                </div>
              </div>
            </div>
            <div class="col-sm12 col-lg" style="display: flex; margin-top: 25px; margin-left:30px;">
              <!-- <div class="col-1" style="flex: 1; flex-grow: 0; flex-shrink:0">
                <img src="../img/icons/notification.png" id="notification-image">
              </div> -->
              <%if(user.role == 'directrice'){%>
              <div class="col-1" style="flex: 1; margin-left: 14px; flex-grow: 0;flex-shrink:0;margin-top:-4px;">
                <a href="/dashboard/settings">
                  <img src="../img/icons/settings.png" id="settings-image">
                </a>
              </div>
              <%}%>
              <div class="col-1" style="flex: 1; margin-left: 14px; flex-grow: 0;flex-shrink:0">
                <form action="/logout" method="post">
                  <button style="border: none; background: none;">
                    <img src="../img/icons/logout.png">
                  </button>
                </form>
              </div>
            </div>
          </div>
          </div>
        </div> 
      </div>
    <div class="mt-5" style="margin-left: 20px;">
      <%if((user.role == 'directrice') && (user.role == 'administrateur')){%>
        <div class="row flex-nowrap" style="width: 100%; overflow-x: scroll; scrollbar-width: none; align-items: center;">
          <div class="col">
            <div class="card-info shadow" style="margin-right: 10px; display: flex;">
              <div class="div-color border1" style="display: inline-block;"></div>
              <div class="card-font1">Nombre total des enfants</div>
              <div class="card-font2"><%=nbr_eleve%></div>
            </div>
          </div>
          <div class="col">
            <div class="card-info shadow ml-2" style="margin-right: 10px; display: flex;">
              <div class="div-color border2" style="display: inline-block;"></div>
              <div class="card-font1">Nombre total des enfants personnel</div>
              <div class="card-font2"><%=personnel%></div>
            </div>
          </div>
          <div class="col">
            <div class="card-info shadow ml-2" style="margin-right: 10px; display: flex;">
              <div class="div-color border3" style="display: inline-block;"></div>
              <div class="card-font1">Nombre total des payés</div>
              <div class="card-font2"><%=paye%></div>
            </div>
          </div>
          <div class="col">
            <div class="card-info shadow ml-2" style="margin-right: 10px; display: flex;">
              <div class="div-color border4" style="display: inline-block;"></div>
              <div class="card-font1">Nombre total des impayés</div>
              <div class="card-font2"><%=impaye%></div>
            </div>
          </div>
          <div class="col">
            <div class="card-info shadow ml-2" style="margin-right: 10px; display: flex;">
              <div class="div-color border5" style="display: inline-block;"></div>
              <div class="card-font1">Total d'enfant en cantine de 4 jours</div>
              <div class="card-font2"><%=cantine_1%></div>
            </div>
          </div>
          <div class="col">
            <div class="card-info shadow ml-2" style="margin-right: 10px; display: flex;">
              <div class="div-color border1" style="display: inline-block;"></div>
              <div class="card-font1">Total d'enfant en cantine de 5 jours</div>
              <div class="card-font2"><%=cantine_2%></div>
            </div>
          </div>
          <div class="col">
            <div class="card-info shadow ml-2" style="margin-right: 10px; display: flex;">
              <div class="div-color border2" style="display: inline-block;"></div>
              <div class="card-font1">Total service de garde Am/Pm</div>
              <div class="card-font2"><%=gardes_1%></div>
            </div>
          </div>
          <div class="col">
            <div class="card-info shadow ml-2" style="margin-right: 10px; display: flex;">
              <div class="div-color border3" style="display: inline-block;"></div>
              <div class="card-font1">Total service de gardes mercredi</div>
              <div class="card-font2"><%=mercredi%></div>
            </div>
          </div>
          <div class="col">
            <div class="card-info shadow ml-2" style="margin-right: 10px; display: flex;">
              <div class="div-color border4" style="display: inline-block;"></div>
              <div class="card-font1">Total enfant avec transport</div>
              <div class="card-font2"><%=transport%></div>
            </div>
          </div>
        </div>
      
    </div>
    <div style="border-bottom:1px solid grey; margin-top: 10px; width: 100%;"></div>
    <%}%>
    <div  style="margin-top: 40px; margin-left: 20px;">
        <div class="row" >
          <form action="/dashboard" method="POST">
          <div class="col-lg-3 col-sm-12"><span class="big-font">Filtres</span>
            <ul class="list-group shadow" style="width: 250px;">
              <li class="list-group-item text-left">classes<img src="../img/icons/arrow.png" class="float-right click" >
                <ul style="margin-right:23px;margin-top:5px;" class="ul-test">
                  <span id="ejs-filter"><%for(let i=1;i<=nbr_classe;i++){%></span>
                  <li style="list-style: none; margin-left: 30px;">
                      <input class="form-check-input" type="checkbox" value=<%=i%> name="class_check" id="class_check<%=i%>">
                      <%if(i==1){%>
                        Swans
                      <%}%>
                      <%if(i == 2){%>
                        Little foxes
                      <%}%>
                      <%if(i == 3){%>
                        Foxes
                      <%}%>
                      <%if(i == 4){%>
                        Bears
                      <%}%>
                      <%if(i == 5){%>
                        Seals
                      <%}%>
                      <%if(i == 6){%>
                        Owls
                      <%}%>
                  </li>
                  <%}%>
                </ul>
              </li>
              <li class="list-group-item text-left">Payement<img src="../img/icons/arrow.png" class="float-right click4">
                <ul style="margin-right:23px;margin-top:5px;" class="ul-test4">
                  <li style="list-style: none; margin-left: 30px;">
                    <input class="form-check-input" type="checkbox" name="paye">
                    Payé
                  </li>
                  <li style="list-style: none; margin-left: 30px;">
                    <input class="form-check-input" type="checkbox" name="impaye">
                    Impayé
                  </li>
                </ul>
              </li>
              <li class="list-group-item text-left">Transport<img src="../img/icons/arrow.png" class="float-right click1">
                <ul style="margin-right:23px;margin-top:5px;" class="ul-test1">
                  <li style="list-style: none; margin-left: 30px;">
                    <input class="form-check-input" type="checkbox" name="transport1">
                    Oui
                  </li>
                  <li style="list-style: none; margin-left: 30px;">
                    <input class="form-check-input" type="checkbox" name="transport2">
                    Non
                  </li>
                </ul>
              </li>
              <li class="list-group-item text-left">Service de garde<img src="../img/icons/arrow.png" class="float-right click2" >
                <ul style="margin-right:23px;margin-top:5px;" class="ul-test2">
                  <li style="list-style: none; margin-left: 30px;">
                    <input class="form-check-input" type="checkbox" name="g_am" value="1">
                    AM
                  </li>
                  <li style="list-style: none; margin-left: 30px;">
                    <input class="form-check-input" type="checkbox" name="g_pm" value="2">
                    PM
                  </li>
                </ul>
              </li>
              <li class="list-group-item text-left">Garde mercredi après-midi<img src="../img/icons/arrow.png" class="float-right click3">
                <ul style="margin-right:23px;margin-top:5px;" class="ul-test3">
                  <li style="list-style: none; margin-left: 30px;">
                    <input class="form-check-input" type="checkbox" name="mercredi_oui">
                    Oui
                  </li>
                  <li style="list-style: none; margin-left: 30px;">
                    <input class="form-check-input" type="checkbox" name="mercredi_non">
                    Non
                  </li>
                  
                </ul>
              </li>
              <li class="list-group-item text-left">
                <button class="btn btn-primary">filtrer!</button>
              </li>
            </ul>
            </div>
          </form>
          <div class="col-lg-9 col-sm-12">
            <!-- test -->
            <%j=0;for(let i=1;i<=nbr_classe;i++){%>
              <div class="class<%=i%>">
              <span class="big-font">Classe: <%if(i==1){%>
                Swans
              <%}%>
              <%if(i == 2){%>
                Little foxes
              <%}%>
              <%if(i == 3){%>
                Foxes
              <%}%>
              <%if(i == 4){%>
                Bears
              <%}%>
              <%if(i == 5){%>
                Seals
              <%}%>
              <%if(i == 6){%>
                Owls
              <%}%></span>
              
              <div class="row mt-2 flex-nowrap" style="width: 100%; overflow-x: scroll; scrollbar-width: none; flex-shrink:0; margin-bottom: 15px; margin-left: -40px;">
                  <%enfant.forEach((element) => {%>
                    <%if(element.classe == i){j++;%>
                  <div class="col-lg-2 col-md-6 col-sm-6 col-xs-3 mt-2 ml-4">
                      <div class="card shadow-sm card-eleve float-left" style="border-radius: 24px; overflow: hidden;">
                        <div class="text-center">
                          <!-- <div class="card-title rounded-circle" style=" width: 110px; height: 110px; background: rgb(255, 0, 234); margin-left: 90px; margin-top: 10px;"> -->
                            <img class="rounded-circle" style="width:80px; height: 80px; margin-top: 4.5px;" src="/files/avatar/<%=element.image%>" class="card-img-top">
                            <span class="prenom"><%=element.prenom%></span>
                            <span class="nom"><%=element.nom%></span>
                        </div>
                  </div>
                  </div>
                  <%}%>
                  <%});%>
                </div>
              </div>
              
            <%}%>
          </div>
        </div>
    </div>
  </section>
  <script src="../scripts/dashboard.js" type="text/javascript"></script>
  <script>
    <%j=0;for(let i=1;i<=nbr_classe;i++){%>
      <%for(let k=0;k<enfant.length;k++){%>
        <%if(enfant[k].classe == i){j++;}%>
      <%}%>
      <%if(j == 0){%>
        document.querySelector(".class<%=i%>").style.display = "none";
      <%}%>
    <%j=0;}%>
    <%for(let i=1;i<=nbr_classe;i++){%>
      <%for(let k=0;k<enfant.length;k++){%>
        <%if(!user.classe.includes(i) && (user.role=="educatrice")){%>
          document.querySelector(".class<%=i%>").style.display = "none";
          <%}%>
      <%}%>
    <%}%>
    const search = document.querySelector("#search-input");
    const card = document.querySelectorAll(".card-eleve");
    setInterval(()=>{
  card.forEach((tmp)=>{

    if(tmp.childNodes[1].childNodes[5].textContent.includes(search.value) || tmp.childNodes[1].childNodes[7].textContent.includes(search.value)){
      tmp.style.visibility = 'visible';
    }
    else{
      tmp.style.visibility = 'hidden';
    }
    if(search.value == ""){
    tmp.style.visibility = 'visible';
  }
  });
}, 100);
  </script>
</body>
</html>
