<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>rapport clone</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap');
        *{
            font-family: 'Montserrat';
        }
        #logo{
            margin-left: 80px;
            display:inline-block;
            width: 100vw;
        }
        #logo img{
            width: 50px;
            height: 50px;
            position: fixed;
            right: 50px;
            top:60px;
            /* float:right;
            margin-top: -220px;
            margin-right: 150px; */
        }
        .card{
            margin-top: 50px;
            padding-top: 10px;
            padding-bottom: 10px;
            padding-left: 15px;
            padding-right: 15px;
            width: 230px;
            background: rgb(223, 215, 215);
            border-radius: 10px;
        }
        .card p {
            margin-left: 20px;
            font-size: 8px;
            font-weight: 300;
        }
        .number{
            font-weight: 700;
            float: right;
        }
        .left-border{
            position: fixed;
            top:0;
            left: 0;
            width: 30px;
            height: 900vh;
            background: #ED7D27;
        }
        .container{
            margin-left: 20px;
        }
        .title{
            color: #ED7D27;
            font-weight: 700;
            font-size: 28px;
        }
        .table{
            margin-left: 80px;
            font-size: 8px;
        }
        .table p{
            margin-left: 10px;
            margin-top: 40px;
            font-size: 10px;
            font-weight: 700;
        }
        table{
            border-collapse: collapse;
            width: 80%;
        }
        td,th{
            border: 1px solid #ddd;
            border-left:0;
            border-right:0;
        }
        th{
            border-top: 0;
            /* float:left; */
            text-align: left;
        }
        tr:nth-child(even){background-color: #f2f2f2;}
        .prix{
            width: 20%;
            margin-top: 50px;
            margin-left: 430px;
            border-top: 1px solid black;
        }
        .prix th, .prix td{
            border: 0;
            background: white;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="left-border"></div>
    <div class="container">
        <div id="logo">
            <p class="title">Facture</p>
            <div class="card">
                <p>Père: <span class="number"><%if(pere){%><%=pere.nom+" "+pere.prenom%><%}%></span></p>
                <p>Mère: <span class="number"><%if(mere){%><%=mere.nom+" "+mere.prenom%><%}%></span></p>
                <br>
                <p>enfant: <span class="number"> <%=enfant.nom+" "+enfant.prenom%></span></p>
                <p>Nom de classe: <span class="number"><%if(enfant.classe==1){%>
                    Swans
                  <%}%>
                  <%if(enfant.classe == 2){%>
                    Little foxes
                  <%}%>
                  <%if(enfant.classe == 3){%>
                    Foxes
                  <%}%>
                  <%if(enfant.classe == 4){%>
                    Bears
                  <%}%>
                  <%if(enfant.classe == 5){%>
                    Seals
                  <%}%>
                  <%if(enfant.classe == 6){%>
                    Owls
                  <%}%></span></p>
                <p>Date<span class="number">01/<%=month.slice(5)%>/<%=month.slice(0,4)%><%=//month.getFullYear()%></span></p>
            </div>
            <img src="http://localhost:3000/img/Logo.png">
        </div>
        <div class=table>
            <%let total = 0;let tmp = [];cpt=0;%>
            <p>Valeur en DHS</p>
            <%=prix%>
            <%=mere%>
            <table>

                <tr>
                    <th>Description</th>
                    <th>Prix</th>
                    <th>Qte</th>
                    <th>Date</th>
                    <th>Total</th>
                </tr>
                <%impaye.forEach((x)=>{%>
                    <%//if ((x.date.getMonth()+1) == Number.parseInt(month.slice(5)) && (x.date.getFullYear() == Number.parseInt(month.slice(0,4))) ){%>
                        <tr>
                    <td>Scolarité</td>
                    <%if(enfant.type_scolarite == 1){%>
                        <td><%=prix.scolarite_ancien%></td>
                        <%total += prix.scolarite_ancien%>
                    <%}%>
                    <%if(enfant.type_scolarite == 2){%>
                        <td><%=prix.scolarite_nv%>dh</td>
                        <%total += prix.scolarite_nv%>
                    <%}%>
                    <td>1</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Transport</td>
                    <%if(enfant.transport){%>
                        <%if(enfant.type_transport == 1){%>
                            <td><%=prix.trajet%></td>
                            <%total += prix.trajet%>
                        <%}%>
                        <%if(enfant.type_transport == 2){%>
                            <td><%=prix.trajet%></td>
                            <%total += prix.trajet%>
                        <%}%>
                        <%if(enfant.type_transport == 3){%>
                            <td><%=prix.aller_retour%></td>
                            <%total += prix.aller_retour%>
                        <%}%>
                    <%}else{%>
                        <td></td>
                    <%}%>
                    <%if(enfant.transport){%>
                    <td>1</td>
                    <%}else{%>
                        <td></td>
                    <%}%>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Service de Garde</td>
                    <td>
                    <%if(enfant.gardes){%>
                        <%if(enfant.gardes_type.includes(1)){%>
                            <%=prix.garde%><br>
                            <%total += prix.garde%>
                        <%}%>
                        <%if(enfant.gardes_type.includes(2)){%>
                            <%=prix.garde%><br>
                            <%total += prix.garde%>
                        <%}%>
                    <%}else{%>
                       <span></span>>
                    <%}%>
                </td>
                    <%if(enfant.gardes){%>
                    <td>1</td>
                    <%}else{%>
                        <td></td>
                    <%}%>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Service de garde mercredi après-midi</td>
                        <%if(enfant.mercredi){%>
                        <td><%=prix.mercredi%></td>
                        <%total += prix.mercredi%>
                    <%}else{%>
                        <td></td>
                    <%}%>
                        <%if(enfant.mercredi){%>
                            <td>1</td>>
                        <%}else{%>
                            <td></td> 
                        <%}%>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Cantine</td>
                    <%if(enfant.cantine){%>
                        <%if(enfant.type_cantine == 1){%>
                            <td><%=prix.cantine4%></td>
                            <%total += prix.cantine4%>
                        <%}%>
                        <%if(enfant.type_cantine == 2){%>
                            <td><%=prix.cantine5%></td>
                            <%total += prix.cantine5%>
                        <%}%>
                    <%}else{%>
                        <td></td>
                    <%}%>
                    <%if(enfant.cantine){%>
                    <td>1</td>
                    <%}else{%>
                        <td></td>
                    <%}%>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <%if(trajet_unitaire){%>
                        <%tmp = trajet_unitaire.split(",")%>
                        <td>Trajet Unitaire</td>
                        <td><%=tmp.length*prix.trajet_unitaire%></td>
                        <td><%=tmp.length%></td>
                        <td><%tmp.forEach((date)=>{%>
                            <%=date%><br>
                        <%})%></td>
                        <td></td>
                        <%total += tmp.length*prix.trajet_unitaire%>
                    <%}%>
                </tr>
                <tr>
                    <%if(cantine_unitaire){%>
                        <%tmp = cantine_unitaire.split(",")%>
                        <td>Cantine Unitaire</td>
                        <td><%=tmp.length*prix.cantine_unitaire%></td>
                        <td><%=tmp.length%></td>
                        <td><%tmp.forEach((date)=>{%>
                            <%=date%><br>
                        <%})%></td>
                        <td></td>
                        <%total += tmp.length*prix.cantine_unitaire%>
                    <%}%>
                </tr>
                <tr>
                    <%if(mercredi_unitaire){%>
                        <%tmp = mercredi_unitaire.split(",")%>
                        <td>Mercredi Unitaire</td>
                        <td><%=tmp.length*prix.mercredi_unitaire%></td>
                        <td><%=tmp.length%></td>
                        <td><%tmp.forEach((date)=>{%>
                            <%=date%><br>
                        <%})%></td>
                        <td></td>
                        <%total += tmp.length*prix.mercredi_unitaire%>
                    <%}%>
                </tr>
                <tr>
                    <%if(retart_garde){%>
                        <%tmp = retart_garde.split(",")%>
                        <td>Retard de garde</td>
                        <td><%=tmp.length*50%></td>
                        <td><%=tmp.length%></td>
                        <td><%tmp.forEach((date)=>{%>
                            <%=date%><br>
                        <%})%></td>
                        <td></td>
                        <%total += tmp.length*50%>
                    <%}%>
                </tr>
                <tr>
                    <%if(retart_paiement){%>
                        <%tmp = retart_paiement.split(",")%>
                        <td>Retard de paiement</td>
                        <td><%=tmp.length*50%></td>
                        <td><%=tmp.length%></td>
                        <td><%tmp.forEach((date)=>{%>
                            <%=date%><br>
                        <%})%></td>
                        <td></td>
                        <%total += tmp.length*50;%>
                    <%}%>
                </tr>
                <%if(enfant.inscription){%>
                    <%if(inscription){%>
                <tr>
                    <td>Inscription</td>
                    <td><%=prix.inscription%></td>
                    <td>1</td>
                    <td></td>
                    <td></td>
                    <%total += prix.inscription%>
                </tr>
                <%}%>
                <%}%>
                <%//}%>
                <%})%>
            </table>
            <br>
            <table class="prix">
                <tr style="margin-top: 10px;">
                    <th>Somme</th>
                    <td><%=total%></td>
                </tr>
                <tr>
                    <th>Remise</th>
                    <td><%=remise%>%</td>
                </tr>
                <%if(remise){%>
                <tr>
                    <th>Total</th>
                    <td><%=total-(total*(remise/100))%></td>
                </tr>
                <%}%>
            </table>
        </div>
    </div>
</body>
</html>